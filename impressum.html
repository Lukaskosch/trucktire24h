<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Impressum & Datenschutz – Kosch mobiler Reifenservice · 24h LKW-Notdienst</title>
  <meta name="robots" content="index,follow" />
  <link rel="icon" href="/favicon-96.png" sizes="96x96" type="image/png">
<link rel="icon" href="/favicon-64.png" sizes="64x64" type="image/png">
<link rel="icon" href="/favicon-48.png" sizes="48x48" type="image/png">
<link rel="icon" href="/favicon-32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16.png" sizes="16x16" type="image/png">
<link rel="apple-touch-icon" href="/icon-180.png" sizes="180x180">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#0f172a">
  <script src="assets/cookie-banner.js" defer></script>
  <style>
    :root{
      --bg:#f7f7f8; --text:#1f2937; --muted:#667085; --card:#ffffff; --border:#e5e7eb;
      --shadow:0 6px 18px rgba(0,0,0,.08); --radius:14px; --container:1120px;
      --accent:#335d92; --accent-weak:#ecf2f9;
      --dark:#0f172a; --dark-border:#1f2937; --dark-soft:#334155; --dark-text:#e5e7eb;
      --focus:#2563eb;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:'Segoe UI','Helvetica Neue',Arial,sans-serif;overflow-x:hidden}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;height:auto;display:block}

    /* Topbar */
    nav.topbar{position:sticky;top:0;z-index:1000;background:linear-gradient(90deg,#fff700,#fff);box-shadow:0 2px 6px rgba(0,0,0,.08)}
    .nav-row{display:flex;align-items:center;gap:12px;padding:10px 16px;max-width:var(--container);margin:0 auto}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{height:42px}
    .header-text{flex:1;min-width:0;text-align:center;font-size:12px;font-weight:600;color:#444;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .call-button{display:inline-flex;align-items:center;gap:8px;font-size:13px;padding:8px 12px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.08)}
    .call-button--dark{color:#fff;background:var(--dark);border:1px solid var(--dark-border)}

    /* Subnav + Lupe */
    .subnav{position:relative;background:var(--dark);color:var(--dark-text);border-bottom:1px solid var(--dark-border);z-index:900}
    .subnav-inner{max-width:var(--container);margin:0 auto;padding:8px 0}
    .subnav-row{display:flex;align-items:center;gap:8px;padding:0 16px}
    .subnav-scroll{display:flex;gap:8px;overflow-x:auto;white-space:nowrap;scrollbar-width:none;-webkit-overflow-scrolling:touch;touch-action:pan-x;overscroll-behavior-x:contain;-webkit-user-select:none;user-select:none;flex:1}
    .subnav-scroll::-webkit-scrollbar{display:none}
    .subnav a{display:inline-block;color:var(--dark-text);font-size:14px;padding:8px 12px;border-radius:10px;border:1px solid transparent}
    .subnav a:hover{background:rgba(255,255,255,.06);color:#fff}
    .subnav a.active{background:rgba(255,255,255,.10);color:#fff;border-color:var(--dark-soft)}
    .subnav-tools{display:flex;align-items:center;gap:8px}
    .icon-btn{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:10px;border:1px solid #334155;background:rgba(255,255,255,.06);color:#e5e7eb;cursor:pointer}
    .icon-btn svg{width:18px;height:18px}

    /* Suche (global, standardmäßig zu) */
    .search-wrap{max-width:var(--container);margin:8px auto 0;padding:0 16px;position:relative;z-index:1500;display:none}
    .search-wrap.open{display:block}
    .search-bar{display:flex;align-items:center;gap:8px;background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);padding:8px}
    .search-input{flex:1;border:none;background:transparent;outline:none;font-size:16px;padding:10px 6px}
    .search-btn{border:none;background:var(--dark);color:#fff;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
    .search-dropdown{position:absolute;left:16px;right:16px;top:calc(100% + 8px);background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:0 12px 28px rgba(0,0,0,.18);max-height:60vh;overflow:auto;z-index:1600}
    .hidden{display:none}
    .result-item{display:block;padding:10px 12px;border-bottom:1px solid #f1f5f9}
    .result-item:last-child{border-bottom:none}
    .result-title{font-weight:700;font-size:14px}
    .result-snippet{font-size:13px;color:#6b7280;margin-top:3px}

    /* Seite */
    .container{max-width:var(--container);margin:0 auto;padding:28px 16px}
    header.page-hero{background:linear-gradient(180deg,#f7f9fc,#fff);border-bottom:1px solid var(--border)}
    .page-hero h1{margin:0 0 6px;font-size:clamp(26px,4vw,34px)}
    .page-hero p{margin:0;color:var(--muted)}

    .grid{display:grid;gap:20px}
    .grid.cols-2{grid-template-columns:2fr 3fr}
    @media (max-width:960px){.grid.cols-2{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:18px}
    .card h2{margin:0 0 8px}
    .muted{color:var(--muted)}

    .with-stripe{position:relative}
    .with-stripe:before{content:"";position:absolute;left:-12px;top:0;bottom:0;width:6px;background:linear-gradient(180deg,#ffe24d,#fff700);border-radius:4px}

    /* Footer */
    footer{background:#eef2f6;margin-top:32px;text-align:center;border-top:1px solid var(--border)}
    .footer-inner{max-width:var(--container);padding:18px 16px;margin:0 auto;font-size:14px;color:#4b5563}
    .footer-link{color:#4b5563;text-decoration:none;transition:text-decoration .2s ease}
    .footer-link:hover{text-decoration:underline}

    /* List */
    ul.clean{list-style:none;margin:0;padding:0}
    ul.clean li{margin:6px 0}
    h3{margin:14px 0 6px}
    small.code{font-family:ui-monospace,SFMono-Regular,Menlo,monospace;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:6px;padding:2px 6px}
  </style>
</head>
<body>
  <!-- Topbar -->
  <nav class="topbar" aria-label="Hauptnavigation">
    <div class="nav-row">
      <a class="brand" href="index.html" aria-label="Startseite"><img src="logo.png" alt="Kosch mobiler Reifenservice Logo" /></a>
      <div class="header-text">Rechtliches · Impressum & Datenschutz</div>
      <a href="tel:+4915124104553" class="call-button call-button--dark" aria-label="Jetzt anrufen">CALL NOW</a>
    </div>
  </nav>

  <!-- Subnav + Lupe -->
  <div class="subnav" aria-label="Seitennavigation">
    <div class="subnav-inner">
      <div class="subnav-row">
        <div class="subnav-scroll" id="subnavScroll" tabindex="0">
          <a href="index.html">Start</a>
          <a href="notdienst.html">24/7-Notdienst</a>
          <a href="vor-ort-service.html">Vor-Ort-Service</a>
          <a href="flottenservice.html">Für Speditionen</a>
          <a href="einsatzgebiet.html">Einsatzgebiet</a>
          <a href="checkliste-panne.html">Checkliste</a>
          <a href="parkplaetze.html">Parkplätze</a>
          <a href="ueber-uns.html">Über uns</a>
          <a href="kontakt.html">Kontakt</a>
          <a href="impressum.html" class="active">Impressum & Datenschutz</a>
        </div>
        <div class="subnav-tools">
          <button id="toggleSearch" class="icon-btn" aria-expanded="false" aria-controls="searchArea" title="Suche ein-/ausblenden">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Globale Suche (standardmäßig geschlossen) -->
  <div id="searchArea" class="search-wrap" role="search" aria-hidden="true">
    <div class="search-bar" id="searchCard" aria-expanded="false">
      <input id="siteSearch" class="search-input" type="search" placeholder="Suche auf dieser Webseite…" aria-autocomplete="list" aria-controls="searchResults" autocomplete="off" />
      <button id="searchButton" class="search-btn" aria-label="Suche starten">Enter</button>
    </div>
    <div id="searchResults" class="search-dropdown hidden" role="listbox" aria-label="Suchvorschläge"></div>
  </div>

  <!-- HERO -->
  <header class="page-hero">
    <div class="container">
      <h1>Impressum & Datenschutzerklärung</h1>
      <p class="muted">Gültig für die Webseite <a href="https://kosch-service.com">kosch-service.com</a> – Stand: 14.05.2025</p>
    </div>
  </header>

  <main class="container">
    <div class="grid cols-2">
      <!-- IMPRESSUM -->
      <section class="card" id="impressum" aria-labelledby="impressum-title">
        <h2 id="impressum-title">Impressum (§ 5 TMG)</h2>
        <p><strong>Kosch Mobiler Reifenservice</strong><br>
           Inhaber: <strong>Lukas Kosch</strong><br>
           Vorm Dorf 12, 36272 Niederaula, Deutschland</p>

        <p><strong>Kontakt</strong><br>
           Telefon: <a href="tel:+4915124104553">+49&nbsp;151&nbsp;24104553</a><br>
           E-Mail: <a href="mailto:info@kosch-service.com">info@kosch-service.com</a><br>
           Web: <a href="https://kosch-service.com">www.kosch-service.com</a></p>

        <p><strong>Umsatzsteuer-ID</strong><br>
           USt-IdNr.: DE329229298</p>

        <p><strong>Berufsbezeichnung</strong><br>
           Kfz-Techniker-Meister (verliehen in Deutschland)</p>

        <p><strong>Verbraucherstreitbeilegung</strong><br>
           Wir sind nicht verpflichtet und nicht bereit, an Streitbeilegungsverfahren vor einer Verbraucherschlichtungsstelle teilzunehmen. Plattform der EU-Kommission zur Online-Streitbeilegung (OS): <a href="https://ec.europa.eu/consumers/odr/">https://ec.europa.eu/consumers/odr/</a></p>

        <h3>Haftung für Inhalte</h3>
        <p>Als Diensteanbieter sind wir gemäß §&nbsp;7 Abs.&nbsp;1 TMG für eigene Inhalte auf diesen Seiten nach den allgemeinen Gesetzen verantwortlich. Nach §§&nbsp;8–10 TMG sind wir jedoch nicht verpflichtet, übermittelte oder gespeicherte fremde Informationen zu überwachen oder nach Umständen zu forschen, die auf eine rechtswidrige Tätigkeit hinweisen. Verpflichtungen zur Entfernung oder Sperrung der Nutzung von Informationen nach den allgemeinen Gesetzen bleiben unberührt.</p>

        <h3>Haftung für Links</h3>
        <p>Unser Angebot enthält Links zu externen Websites Dritter, auf deren Inhalte wir keinen Einfluss haben. Für diese fremden Inhalte wird keine Gewähr übernommen. Für die Inhalte der verlinkten Seiten ist stets der jeweilige Anbieter oder Betreiber verantwortlich.</p>

        <h3>Urheberrecht</h3>
        <p>Die durch den Seitenbetreiber erstellten Inhalte und Werke auf diesen Seiten unterliegen dem deutschen Urheberrecht. Vervielfältigung, Bearbeitung, Verbreitung und jede Art der Verwertung außerhalb der Grenzen des Urheberrechts bedürfen der vorherigen schriftlichen Zustimmung des jeweiligen Autors bzw. Erstellers.</p>

        <h3>Bild- & Markenhinweise</h3>
        <p>Bilder/Grafiken: eigene Aufnahmen und Grafiken; technische Icons/Frameworks: Leaflet, OpenStreetMap – jeweils Rechte der jeweiligen Anbieter.</p>
      </section>

      <!-- DATENSCHUTZ -->
      <section class="card" id="datenschutz" aria-labelledby="ds-title">
        <h2 id="ds-title">Datenschutzerklärung</h2>
        <p>Wir informieren nach Art.&nbsp;13/14 DSGVO über Art, Umfang und Zwecke der Verarbeitung personenbezogener Daten bei Nutzung dieser Webseite.</p>

        <h3>1. Verantwortlicher</h3>
        <p>Kosch Mobiler Reifenservice, Inhaber: Lukas Kosch<br>
           Vorm Dorf 12, 36272 Niederaula, Deutschland<br>
           E-Mail: <a href="mailto:info@kosch-service.com">info@kosch-service.com</a>, Tel.: <a href="tel:+4915124104553">+49&nbsp;151&nbsp;24104553</a></p>

        <h3>2. Hosting & Server-Logs</h3>
        <p>Die Webseite wird über <strong>GitHub Pages</strong> ausgeliefert (GitHub, Inc., 88 Colin P. Kelly Jr. St., San Francisco, CA 94107, USA), einem Unternehmen der <strong>Microsoft Corporation</strong> (One Microsoft Way, Redmond, WA 98052, USA). Die Domain wurde bei Microsoft registriert. Beim Aufruf werden automatisch Server-Logfiles verarbeitet (z.&nbsp;B. IP-Adresse, Datum/Uhrzeit, aufgerufene URL, Referrer-URL, User-Agent, Statuscode). Rechtsgrundlage: Art.&nbsp;6 Abs.&nbsp;1 lit.&nbsp;f DSGVO (berechtigtes Interesse an technischer Bereitstellung & Sicherheit). Löschung nach den Anbietervorgaben.</p>
        <p><strong>Datenschutz der Anbieter:</strong><br>
          GitHub: <a href="https://docs.github.com/en/site-policy/privacy-policies/github-privacy-statement" target="_blank" rel="noopener noreferrer">GitHub Privacy Statement</a><br>
          Microsoft: <a href="https://privacy.microsoft.com/de-de/privacystatement" target="_blank" rel="noopener noreferrer">Microsoft Datenschutzerklärung</a>
        </p>

        <h3>3. Kontaktaufnahme (Telefon/E-Mail/Formular)</h3>
        <p>Bei Kontaktaufnahme verarbeiten wir Ihre Angaben zur Bearbeitung der Anfrage und etwaiger Anschlussfragen. Rechtsgrundlagen: Art.&nbsp;6 Abs.&nbsp;1 lit.&nbsp;b DSGVO (Vertrag/Anbahnung) und ggf. lit.&nbsp;f DSGVO (berechtigtes Interesse an effizienter Kommunikation). Speicherdauer: bis zur abschließenden Bearbeitung bzw. entsprechend gesetzlicher Aufbewahrungspflichten.</p>

        <h3>4. Einwilligungsverwaltung (Cookie-Einstellungen)</h3>
        <p>Wir verwenden ein eigenes Einwilligungs-Banner. Ihre Auswahl wird in <strong>localStorage</strong> unter dem Schlüssel <small class="code">tt24Consent</small> gespeichert (Kategorien „necessary“, „analytics“, „marketing“, Zeitstempel). Rechtsgrundlage: §&nbsp;25 Abs.&nbsp;2 Nr.&nbsp;2 TTDSG i.&nbsp;V.&nbsp;m. Art.&nbsp;6 Abs.&nbsp;1 lit.&nbsp;c/f DSGVO. Änderung jederzeit unter <a href="cookie.html">Cookie-Einstellungen</a>.</p>

        <h3>5. Analyse</h3>
        <p><em>Derzeit setzen wir keine Statistik-/Analyse-Tools ein.</em> Sollte sich dies ändern, informieren und fragen wir vorab Ihre Einwilligung (Art.&nbsp;6 Abs.&nbsp;1 lit.&nbsp;a DSGVO, §&nbsp;25 Abs.&nbsp;1 TTDSG).</p>

        <h3>6. Karten-Dienste</h3>
        <ul class="clean">
          <li><strong>Google&nbsp;Maps (nur nach Einwilligung)</strong><br>
              Auf <code>parkplaetze.html</code> binden wir Google&nbsp;Maps erst nach Ihrer Zustimmung zur Kategorie „Marketing“ ein. Anbieter: Google Ireland Ltd. Dabei können technische Daten (z.&nbsp;B. IP-Adresse, Geräte-/Browser-Infos) an Google übermittelt werden; es ist eine Drittlandübermittlung (u.&nbsp;a. USA) möglich. Rechtsgrundlage: Art.&nbsp;6 Abs.&nbsp;1 lit.&nbsp;a DSGVO, §&nbsp;25 Abs.&nbsp;1 TTDSG (Einwilligung). Widerruf jederzeit über <a href="cookie.html">Cookie-Einstellungen</a>.
              <p style="margin:.4rem 0 0 0;">Datenschutz: <a href="https://policies.google.com/privacy?hl=de" target="_blank" rel="noopener noreferrer">Google Datenschutzerklärung</a></p>
          </li>
          <li><strong>Leaflet / OpenStreetMap</strong><br>
              Auf <code>kontakt.html</code>, <code>parkplaetze.html</code> nutzen wir Leaflet mit OSM-Kacheln. Keine Cookies; der OSM-Server erhält Ihre IP-Adresse und Browser-Daten zur Kachelauslieferung. Rechtsgrundlage: Art.&nbsp;6 Abs.&nbsp;1 lit.&nbsp;f DSGVO (berechtigtes Interesse an nutzerfreundlicher Standortdarstellung).
              <p style="margin:.4rem 0 0 0;">Datenschutz: <a href="https://osmfoundation.org/wiki/Privacy_Policy" target="_blank" rel="noopener noreferrer">OSM Foundation Privacy Policy</a></p>
          </li>
        </ul>

        <h3>7. Empfänger / Auftragsverarbeiter</h3>
        <p>Hosting-/Infrastruktur-Dienstleister (GitHub/Microsoft) und ggf. weitere IT-Dienstleister im Rahmen von Auftragsverarbeitung nach Art.&nbsp;28 DSGVO.</p>

        <h3>8. Speicherdauer</h3>
        <p>Verarbeitung personenbezogener Daten nur solange erforderlich bzw. gesetzliche Aufbewahrungsfristen bestehen; danach Löschung oder Anonymisierung.</p>

        <h3>9. Ihre Rechte</h3>
        <p>Rechte auf Auskunft (Art.&nbsp;15), Berichtigung (Art.&nbsp;16), Löschung (Art.&nbsp;17), Einschränkung (Art.&nbsp;18), Datenübertragbarkeit (Art.&nbsp;20), Widerspruch (Art.&nbsp;21) sowie Widerruf von Einwilligungen (Art.&nbsp;7 Abs.&nbsp;3 DSGVO). U.&nbsp;a. über <a href="cookie.html">Cookie-Einstellungen</a>.</p>

        <h3>10. Beschwerderecht</h3>
        <p>Beschwerde bei einer Datenschutz-Aufsichtsbehörde möglich, z.&nbsp;B. beim Hessischen Beauftragten für Datenschutz und Informationsfreiheit.</p>

        <h3>11. Änderungen</h3>
        <p>Wir passen diese Datenschutzerklärung an, wenn sich Rechtslage, unser Angebot oder eingesetzte Dienste ändern. Die jeweils aktuelle Fassung finden Sie auf dieser Seite (Stand-Datum oben).</p>
      </section>
    </div>

    <!-- Cookie-Einstellungen -->
    <section class="card with-stripe" style="margin-top:16px">
      <h2>Cookie-Einstellungen</h2>
      <p>Hier können Sie Ihre Auswahl ändern:
        <a class="btn" href="cookie.html" style="display:inline-block;padding:10px 14px;border:1px solid var(--border);border-radius:10px;background:#fff">Cookie-Einstellungen öffnen</a>
      </p>
    </section>
  </main>

  <footer>
    <div class="footer-inner">
      Kosch Mobiler Reifenservice &middot; 24h LKW-Notdienst ·
      <a href="impressum.html" class="footer-link">Impressum & Datenschutz</a> ·
      <a href="cookie.html" class="footer-link">Cookie-Einstellungen</a>
      <div>© <span id="year"></span> Kosch Mobiler Reifenservice. Alle Rechte vorbehalten.</div>
    </div>
  </footer>

  <script>
    (function(){var y=document.getElementById('year');if(y)y.textContent=new Date().getFullYear();})();

    // Subnav: nur Touch wischbar
    (function(){
      const scroller = document.getElementById('subnavScroll');
      if(!scroller) return;
      const isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
      if(!isTouch) return;
      let startX=0, startLeft=0, moved=false;
      scroller.addEventListener('touchstart', e=>{ startX=e.touches[0].clientX; startLeft=scroller.scrollLeft; moved=false; }, {passive:true});
      scroller.addEventListener('touchmove', e=>{ const dx=e.touches[0].clientX-startX; scroller.scrollLeft=startLeft-dx; if(Math.abs(dx)>12) moved=true; }, {passive:true});
      scroller.addEventListener('touchend', ()=>{ setTimeout(()=>moved=false,0); }, {passive:true});
      scroller.addEventListener('click', (e)=>{ if(moved){ e.preventDefault(); e.stopPropagation(); moved=false; } }, true);
    })();

    // Lupe: Suchleiste toggeln
    (function(){
      const btn = document.getElementById('toggleSearch');
      const area = document.getElementById('searchArea');
      const input = document.getElementById('siteSearch');
      if(!btn || !area) return;
      btn.addEventListener('click', ()=>{
        const open = !area.classList.contains('open');
        area.classList.toggle('open', open);
        area.setAttribute('aria-hidden', String(!open));
        btn.setAttribute('aria-expanded', String(open));
        if(open){ setTimeout(()=> input && input.focus(), 120); }
      });
    })();

    // Client-Side Suche mit Vorschlägen
    const SITE_INDEX = [
      {title:'Start', url:'index.html', snippet:'Soforthilfe bei LKW-Reifenpannen, 24/7 erreichbar.'},
      {title:'24/7-Notdienst', url:'notdienst.html', snippet:'Rund um die Uhr Hilfe bei Reifenpannen – auch an Feiertagen.'},
      {title:'Vor-Ort-Service', url:'vor-ort-service.html', snippet:'Reifenmontage und Service direkt am Einsatzort.'},
      {title:'Für Speditionen', url:'flottenservice.html', snippet:'Planbarer Service und Konditionen für Ihre LKW-Flotte.'},
      {title:'Einsatzgebiet', url:'einsatzgebiet.html', snippet:'Alle Einsatzbereiche, Dreiecke und Regionen im Überblick.'},
      {title:'Checkliste Panne', url:'checkliste-panne.html', snippet:'Sicheres Verhalten bei einer LKW-Panne – Schritt für Schritt.'},
      {title:'Parkplätze & Rastplätze', url:'parkplaetze.html', snippet:'Interaktive Karte mit LKW-Park- und Rastplätzen in der Region.'},
      {title:'Über uns', url:'ueber-uns.html', snippet:'Wer wir sind und wofür Kosch mobiler Reifenservice steht.'},
      {title:'Kontakt', url:'kontakt.html', snippet:'Kontaktformular und direkte Kontaktmöglichkeiten.'},
      {title:'Impressum & Datenschutz', url:'impressum.html', snippet:'Rechtliche Angaben und Datenschutzhinweise.'}
    ];

    const input = document.getElementById('siteSearch');
    const resultsBox = document.getElementById('searchResults');
    const card = document.getElementById('searchCard');
    const btnSearch = document.getElementById('searchButton');

    function normalize(s){ return (s||'').toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu,''); }
    function score(item, q){ const t=normalize(item.title), sn=normalize(item.snippet); let s=0; if(t.includes(q)) s+=8; if(t.startsWith(q)) s+=6; if(sn.includes(q)) s+=2; return s; }
    function highlight(text, q){ if(!q) return text; const esc=q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'); return text.replace(new RegExp('('+esc+')','ig'), '<mark>$1</mark>'); }

    let activeIndex=-1;
    function render(items, rawQ){
      resultsBox.innerHTML='';
      if(items.length===0){ resultsBox.classList.add('hidden'); card.setAttribute('aria-expanded','false'); return; }
      const q = rawQ.trim();
      const frag=document.createDocumentFragment();
      items.slice(0,8).forEach((it,i)=>{
        const a=document.createElement('a'); a.href=it.url; a.className='result-item'; a.setAttribute('role','option'); a.id='res-'+i;
        a.innerHTML=`<div class="result-title">${highlight(it.title,q)}</div><div class="result-snippet">${highlight(it.snippet||'',q)}</div>`;
        frag.appendChild(a);
      });
      resultsBox.appendChild(frag);
      resultsBox.classList.remove('hidden');
      card.setAttribute('aria-expanded','true');
      activeIndex=-1;
    }
    function search(){
      const q=normalize(input.value.trim());
      if(!q){ resultsBox.classList.add('hidden'); card.setAttribute('aria-expanded','false'); return; }
      const ranked=SITE_INDEX.map(it=>({it,s:score(it,q)})).filter(x=>x.s>0).sort((a,b)=>b.s-a.s).map(x=>x.it);
      render(ranked, input.value);
    }
    let t=null; input && input.addEventListener('input', ()=>{ clearTimeout(t); t=setTimeout(search,80); });
    btnSearch && btnSearch.addEventListener('click', search);
    input && input.addEventListener('keydown', (e)=>{
      const items=[...resultsBox.querySelectorAll('.result-item')];
      const open=!resultsBox.classList.contains('hidden');
      if(e.key==='Enter'){
        if(open && items.length>0){ e.preventDefault(); location.href=items[0].getAttribute('href'); }
        else{ search(); }
      } else if(open && e.key==='ArrowDown'){ e.preventDefault(); activeIndex=(activeIndex+1)%items.length; items.forEach((el,i)=>el.setAttribute('aria-selected', i===activeIndex?'true':'false')); items[activeIndex].scrollIntoView({block:'nearest'}); }
        else if(open && e.key==='ArrowUp'){ e.preventDefault(); activeIndex=(activeIndex-1+items.length)%items.length; items.forEach((el,i)=>el.setAttribute('aria-selected', i===activeIndex?'true':'false')); items[activeIndex].scrollIntoView({block:'nearest'}); }
    });
    document.addEventListener('click', (e)=>{ const wrap=document.getElementById('searchArea'); if(wrap && !wrap.contains(e.target)){ resultsBox.classList.add('hidden'); card.setAttribute('aria-expanded','false'); } });
  </script>
</body>
</html>




